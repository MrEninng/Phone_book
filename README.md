# Phone_book
    Phone book Documentation.

Задание: 

Создание кроссплатформенного приложения “Телефонная Книга”, позволяющего пользователю сохранять и изменять данные. Так же пользователь должен иметь возможность посмотреть диаграммы, в которых отражено количество людей по гендерному признаку и по дате рождения.
 
Постановка задачи:

Создание кроссплатформенного приложения.
Хранение данных с использованием Базы Данных (Sql).
Дружелюбный интерфейс позволяющий пользователю добавлять  контакты в таблицу, удалять данные о контакте(ах) , изменять данные,просмотреть полную информацию о контакте, искать пользователя по предложенным полям(id, Surname, Name). 
Сериализация данных в форматы  JSON и txt. 
Создание диаграмм с использованием QPainter.
Обработка вводимых пользователем данных на валидность.

Мануал пользователя:

Программный компонент “Phone book” (телефонная книга) предназначен для хранения телефонных номеров, ФИО абонентов, их адреса, пол и дату рождения.

Разработанная система включает в себя:
Телефонную книгу, представленную в виде таблицы с полями о данных фамилии и имени  абонентов  и их телефонных номерах;
Статистические данные о распределение количества мужчин и женщин в телефонной книге, изображенные в качестве круговой диаграммы;
В программном компоненте реализована возможность редактирования данных, занесенных в телефонную книгу.
Возможность удаления данных из предоставленных таблицей.
Сохранение данных в формате txt.
Чтение данных из файла созданного данным приложением.
Поиск абонента по “id”(индивидуальному номеру абонента в телефонной книге), “Surname”(фамилии) и “Name”(имени).  (В разработке)
Данный продукт выполнен с использованием возможности среды Qt Creator для создания графического интерфейса (GUI) на основе фрейворка Qt. (Рис. 1)

Для добавления абонента в телефонную книгу необходимо заполнить соответствующие поля: имени, фамилии и отчества (причем в данные поля необходимо вносить информацию с заглавных латинских или русских букв, в противном случае, программный компонент не позволит заполнить эти поля) и других полей. Далее необходимо нажать кнопку Add. Если все данные были заполнены верно, то абонент будет добавлен в таблицу, если же какая-либо графа будет заполнена не верно -- пользователь увидит окно с содержанием ошибки.

Для удаления контактов из таблицы     пользователю необходимо выделить необходимую строку(и) нажав на номер строки с пол следующим нажатием кнопки Delete.


Если пользователю необходимо изменить какие-либо данные о контакте ему необходимо предварительно выделив номер строки нажать на кнопку Change Information. Изменив необходимые данные в появившемся окне пользователю необходимо нажать кнопку Submit, чтобы подтвердить изменение данных.

Чтобы просмотреть полную информацию о пользователе (т.к. в таблице показана только основные четыре поля с информацией) пользователю после выделения номера нужной строки необходимо нажать кнопку Personal Information.
Для сохранение или открытия данных в формате TXT пользователю необходимо в блоке меню выбрать соответствующее поле, после нажатия на которое откроется диалоговое окно, в котором необходимо либо выделить необходимый файл, либо ввести его название в поле для ввода.

Для просмотра диаграмм пользователю необходимо в блоке меню выбрать соответствующее поле и выбрать какой тип диаграмм из предложенных он хотел бы увидеть.
Для сохранение или открытия данных в формате TXT пользователю необходимо в блоке меню выбрать соответствующее поле, после нажатия на которое откроется диалоговое окно, в котором необходимо либо выделить необходимый файл, либо ввести его название в поле для ввода.

Для просмотра диаграмм пользователю необходимо в блоке меню выбрать соответствующее поле и выбрать какой тип диаграмм из предложенных он хотел бы увидеть.



Руководство программиста:

В первую очередь после наброска GUI-я была добавлена иконка нашего приложения с использованием QIcon.
Далее был обработан слот isAddButtonClicked(), отвечающий за обработку нажатия на кнопку Add. Для правильной работы данной кнопки было необходимо обработать поля ввода на валидность. Т.е. проверить нет ли вводимого телефона уже в нашей базе данных, введены ли поля имени фамилии и др. Для правильной работы numberLineEdit  было решено использовать inputMask, что позволяет ограничить пользователя в введении букв или неправильного формата номера в данное поле. Для полей Name, Surname и SeconName было решено использовать регулярные выражения и валидатор регулярных выражений. Для этого использовались QRegExp и QRegExpValidator. Для соответствующих полей с помощью метода setValidator() был установлен валидатор  со следующим регулярным выражением “[A-Z|А-Я][a-z | а-я]*”. Данное выражение позволяет пользователю первым символом ввести заглавную букву Русского и Английского языка, а затем только строчные буквы тех же языков. Тем самым мы не даем пользователю вводить некорректные имена с использованием цифр и прочих недопустимых символов. Так же данные поля проверяются на количество введенных символов с помощью метода QLineEdit::length(). Если пользователь ввел 0  или 1 букву, то выбрасывается exeption, с текстом ошибки, который обрабатывается в блоке catch c помощью  QMessageBox, а некорректно заполненное поле окрашивается в красный цвет с помощью метода QLineEdit::setStyleSheet().
Для обработки данных из QDateEdit используется класс QDate, с помощью которого сравнивается вводимые данные с текущим системным временем компьютера. Если все данные валидны, то данные добавляются в базу данных. В своей работе мы использовали SQLITE, т.к. это один из наиболее распространенных видов баз данных, совместимый с большинством операционных систем и идущий в начальном дистрибутиве. Т.е. пользователю не нужно предварительно устанавливать базу данных на свой компьютер, чтобы наше приложение могло корректно работать. Для реализации MVC (Model-View-Controller) использовались QTableView и QQueryModel. Для обработки sql запросов использовался метод exec() класса QSqlQuery. Для корректной работы программы было решено использовать 2 таблицы в базе данных, Phone_book и  Phone_book_info, где содержались id,name,surname, number  и id, second_name, address, date, gender соответственно. Данные в таблице отображались из первой таблицы базы данных(Phone_book).
Для проверки наличия вводимого номера в базе данных использовался соответствующий sql запрос: SELECT Number FROM phone_book. 
    
Стоит более подробно описать процесс создания базы данных. Для этого была создана статическая функция create_connection(),  в которой создавался объект класса QSqlDatabase. Для данного объекта были задействованы методы: 
addDatabase("QSQLITE")
setDatabaseName("phone_book.db"); 
    setUserName("User");
    setHostName("user's_computer");
    setPassword("Password");
В которые соответственно передавались вид базы данных, ее называние, имя пользователя, имя хоста, и пароль. 
    В процессе работы мы встретились с проблемой того, что таблицы базы данных не удаляются после окончания работы приложения. Для корректной работы программы был перегружен метод closeEvent для главного окна. При закрытии программы таблицы удаляются.
    Для кнопки Change Information было создано отдельное окно, при открытии которого поля уже заполнены теми данными, которые принадлежат абоненту на момент нажатия данной кнопки. Для обработки данных использовались аналогичные валидаторы.
Для обработки удаления данных использовался класс QModelIndexList, 
с помощью которого обрабатывается удаление выделенных пользователем строк.
    Для сохранения данных и считывания данных из файла используется класс QFile. Для получения названия сохраняемого или открываемого файла использовались методы QFileDialog::getSaveFileName() и QFileDialog::getOpenFileName() соответственно. Далее идет сохранение данных в файл или открытие данных и добавление их в таблицу.



Выводы по работе:
    Нами было создано кроссплатформенное приложение с дружелюбным интерфейсом, позволяющим пользователю хранить контактные данные.
    Хранилищем данных является база данных SQLITE состоящая из двух таблиц(для удобства обработки).
    Реализовано сохранение данных в формат txt. Также добавлена возможность считывание данных из txt файла созданного приложением. 
    Реализована корректная обработка вводимых пользователем данных с использованием разного рода возможностей, которые предоставляются библиотекой Qt( RegExp, QDate и прочее).
    Была реализованы диаграммы с помощью модуля QPainter.

Что НЕ реализовано:
    Сортировка данных в таблице.
    Поиск данных в таблице.(Не определились с концепцией вывода найденных данных)
    Многопоточность при открытии txt файла. Работа с sql запросами очень сильно замедляет работу приложения при работе с большим количеством данных.
    
